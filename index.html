<!DOCTYPE html>
<html lang="lv">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Klīnika TV</title>
<style>
:root{--bar:86px;--fg:#fff;--bg:#0b1220;--muted:#a9b3c7;--acc:#28a6ff;--speed:35s}
html,body{height:100%;margin:0;background:#000;color:var(--fg);font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,"Noto Sans",sans-serif}

/* Updated layout with z-index and fixed bar */
.wrap { position: fixed; inset: 0; display: block; overflow: hidden; }
.stage { position: relative; background:#000; z-index: 0; }
video  { width:100%; height:100%; object-fit:cover; background:#000; z-index: 0; }
.bar   { position: fixed; left:0; right:0; bottom:0; z-index: 10; height: var(--bar); padding:10px 16px; background:#0b1220; border-top:1px solid rgba(255,255,255,.08); display:grid; grid-template-columns:300px 1fr 320px; gap:16px; align-items:center; }

.time{font-weight:700;font-size:28px} .date{font-size:14px;color:var(--muted)}
.ticker{position:relative;overflow:hidden;white-space:nowrap;height:100%}
.track{position:absolute;display:inline-block;white-space:nowrap;animation:scroll var(--speed) linear infinite;font-size:20px}
@keyframes scroll{from{transform:translateX(100%)}to{transform:translateX(-100%)}}
.ticker strong{color:var(--acc)}
.weather{display:grid;grid-template-columns:56px 1fr;align-items:center;gap:12px;justify-self:end}
.temp{font-size:26px;font-weight:700}.desc{font-size:14px;color:var(--muted);text-transform:capitalize}
.pill{display:inline-block;padding:2px 8px;border-radius:999px;background:rgba(255,255,255,.08);font-size:12px;margin-left:8px;color:var(--muted)}
@media(max-width:900px){.bar{grid-template-columns:1fr;height:auto}.weather{justify-self:start;margin-top:8px}.track{font-size:18px}}
</style>
</head>
<body>
<div class="wrap">
  <div class="stage">
    <video id="player" autoplay muted playsinline></video>
  </div>
  <div class="bar">
    <div>
      <div class="time" id="t">--:--</div>
      <div class="date" id="d">—</div>
    </div>
    <div class="ticker"><div class="track" id="tk">Ielādējas…</div></div>
    <div class="weather">
      <img id="wxI" width="56" height="56" alt=""/>
      <div>
        <div class="temp"><span id="wxT">--</span>°C <span class="pill" id="wxC">Rīga</span></div>
        <div class="desc" id="wxD">—</div>
      </div>
    </div>
  </div>
</div>

<script>
/* ========= IESTATĪJUMI ========= */
const PLAYLIST = [
  "video2.mp4",
  "dermatologija.mp4",
  "videoadm123.mp4",
  "bariatriskaendoskopija.mp4"
];

const OPENWEATHER_API_KEY = "8c38215495b18f116d137cee7fb9d6f1"; // tava atslēga
const LOCATION = { city: "Rīga", lat: 56.9496, lon: 24.1052 };
const WX_MS = 10 * 60 * 1000;
const ND_MS = 12 * 60 * 60 * 1000;

function clock(){const n=new Date();document.getElementById('t').textContent=n.toLocaleTimeString('lv-LV',{hour:'2-digit',minute:'2-digit'});const ds=n.toLocaleDateString('lv-LV',{weekday:'long',year:'numeric',month:'long',day:'numeric'});document.getElementById('d').textContent=ds.charAt(0).toUpperCase()+ds.slice(1);}clock();setInterval(clock,1000);
(function initVideo(){const v=document.getElementById('player');let i=0;function play(k){if(!PLAYLIST.length)return;i=k%PLAYLIST.length;v.src=PLAYLIST[i];v.load();v.play().catch(()=>{});}['ended','stalled','error'].forEach(e=>v.addEventListener(e,()=>play(i+1)));play(0);})();
async function fetchWX(){const u=`https://api.openweathermap.org/data/2.5/weather?lat=${LOCATION.lat}&lon=${LOCATION.lon}&units=metric&lang=lv&appid=${OPENWEATHER_API_KEY}`;const r=await fetch(u,{cache:'no-store'});if(!r.ok)throw new Error("OWM "+r.status);return r.json();}
function renderWX(wx){const t=Math.round(wx.main?.temp??NaN);const d=wx.weather?.[0]?.description||"—";const ic=wx.weather?.[0]?.icon||"01d";document.getElementById('wxT').textContent=isFinite(t)?t:"--";document.getElementById('wxD').textContent=d;document.getElementById('wxC').textContent=LOCATION.city;document.getElementById('wxI').src=`https://openweathermap.org/img/wn/${ic}@2x.png`;}
let lastWX=null;async function updateWX(){try{lastWX=await fetchWX();renderWX(lastWX);}catch(_){}}updateWX();setInterval(updateWX,WX_MS);
async function ndV2(){const n=new Date();const r=await fetch(`https://nameday.abalin.net/api/v2/namedays?country=lv&month=${n.getMonth()+1}&day=${n.getDate()}`,{cache:'no-store'});if(!r.ok)throw 0;const j=await r.json();return j?.data?.names||[];}
async function ndV1(){const r=await fetch("https://nameday.abalin.net/api/V1/today",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({country:"lv"})});if(!r.ok)throw 0;const j=await r.json();return String(j?.nameday?.lv||"").split(",").map(s=>s.trim()).filter(Boolean);}
const LV_NAMEDAYS={"01-01":["Jaunais gads"],"01-02":["Raita","Raits","Raitis"],"01-03":["Kārlis","Karmena"]};
function getLocalNameday(){const n=new Date();const mm=String(n.getMonth()+1).padStart(2,'0');const dd=String(n.getDate()).padStart(2,'0');return LV_NAMEDAYS[`${mm}-${dd}`]||[];}
function buildTicker(names){const ds=new Date().toLocaleDateString('lv-LV',{weekday:'long',year:'numeric',month:'long',day:'numeric'});const nd=names.length?names.join(", "):"—";const wx=lastWX?.main?`Rīga: ${Math.round(lastWX.main.temp)}°C, ${lastWX.weather?.[0]?.description||""}`:"Rīga: —";return ` • <strong>${ds}</strong> • ${wx} • Šodien vārda diena: <strong>${nd}</strong> • `;}
async function updateTicker(){let names=[];try{names=await ndV2();}catch{try{names=await ndV1();}catch{names=getLocalNameday();}}const html=buildTicker(names);document.getElementById('tk').innerHTML=html+html;}updateTicker();setInterval(updateTicker,ND_MS);
</script>
</body>
</html>
